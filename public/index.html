<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Root Cause Power - Complete PTSD Support Platform</title>
    
    <!-- PWA Meta Tags -->
    <meta name="application-name" content="Root Cause Power">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Root Cause Power">
    <meta name="description" content="AI-powered PTSD support platform combining Lifestyle Medicine and Clinical Hypnotherapy">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#10b981">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="./icons/apple-touch-icon-180x180.svg">
    <link rel="apple-touch-icon" sizes="152x152" href="./icons/apple-touch-icon-152x152.svg">
    <link rel="apple-touch-icon" sizes="120x120" href="./icons/apple-touch-icon-120x120.svg">
    <link rel="apple-touch-icon" sizes="76x76" href="./icons/apple-touch-icon-76x76.svg">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="./icons/favicon-32x32.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="./icons/favicon-16x16.svg">
    <link rel="shortcut icon" href="./icons/favicon.ico">
    
    <!-- Stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./css/styles.css">
    <link rel="stylesheet" href="./css/improved-ui.css?v=1.4.0">
    
    <!-- Voice UI Animations -->
    <style>
        .pulse-ring {
            position: absolute;
            border: 3px solid rgba(147, 51, 234, 0.3);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
        }
        
        @keyframes pulse-ring {
            0% { transform: scale(0.8); opacity: 1; }
            100% { transform: scale(1.4); opacity: 0; }
        }
        
        .voice-active {
            animation: voice-pulse 2s ease-in-out infinite alternate;
        }
        
        @keyframes voice-pulse {
            from { box-shadow: 0 0 0 0 rgba(147, 51, 234, 0.7); }
            to { box-shadow: 0 0 0 10px rgba(147, 51, 234, 0); }
        }

        /* Accessibility Features */
        .high-contrast { 
            filter: contrast(150%) brightness(110%); 
        }
        
        .large-text { 
            font-size: 1.25rem !important; 
            line-height: 1.6 !important; 
        }
        
        .extra-large-text { 
            font-size: 1.5rem !important; 
            line-height: 1.7 !important; 
        }
        
        .reduced-motion * { 
            animation-duration: 0.01ms !important; 
            animation-iteration-count: 1 !important; 
            transition-duration: 0.01ms !important; 
        }
        
        .focus-ring:focus {
            outline: 3px solid #fbbf24 !important;
            outline-offset: 2px !important;
        }
        
        .skip-link {
            position: absolute;
            top: -40px;
            left: 6px;
            background: #000;
            color: white;
            padding: 8px;
            text-decoration: none;
            z-index: 1000;
        }
        
        .skip-link:focus {
            top: 6px;
        }

        /* Screen reader only content */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Skip to main content link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Accessibility Toolbar -->
    <div id="accessibility-toolbar" class="fixed top-0 right-0 z-50 bg-white shadow-lg rounded-bl-lg p-2" role="toolbar" aria-label="Accessibility Options">
        <button id="accessibility-toggle" class="w-10 h-10 bg-blue-500 text-white rounded-full hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500" aria-label="Open accessibility options" title="Accessibility Options">
            <i class="fas fa-universal-access"></i>
        </button>
        
        <div id="accessibility-panel" class="hidden mt-2 bg-white border rounded-lg shadow-lg p-4 w-64">
            <h3 class="font-bold mb-3 text-gray-800">Accessibility Options</h3>
            
            <div class="space-y-3">
                <!-- Font Size -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Text Size</label>
                    <div class="flex space-x-2">
                        <button onclick="app.setFontSize('normal')" class="px-3 py-1 text-xs border rounded hover:bg-gray-50" aria-label="Normal text size">A</button>
                        <button onclick="app.setFontSize('large')" class="px-3 py-1 text-sm border rounded hover:bg-gray-50" aria-label="Large text size">A</button>
                        <button onclick="app.setFontSize('extra-large')" class="px-3 py-1 text-base border rounded hover:bg-gray-50" aria-label="Extra large text size">A</button>
                    </div>
                </div>
                
                <!-- High Contrast -->
                <div class="flex items-center justify-between">
                    <label for="high-contrast-toggle" class="text-sm font-medium text-gray-700">High Contrast</label>
                    <input type="checkbox" id="high-contrast-toggle" class="rounded" onchange="app.toggleHighContrast()" aria-describedby="high-contrast-desc">
                </div>
                <p id="high-contrast-desc" class="text-xs text-gray-500">Increases color contrast for better visibility</p>
                
                <!-- Reduced Motion -->
                <div class="flex items-center justify-between">
                    <label for="reduced-motion-toggle" class="text-sm font-medium text-gray-700">Reduce Motion</label>
                    <input type="checkbox" id="reduced-motion-toggle" class="rounded" onchange="app.toggleReducedMotion()" aria-describedby="reduced-motion-desc">
                </div>
                <p id="reduced-motion-desc" class="text-xs text-gray-500">Reduces animations and transitions</p>
                
                <!-- Voice Settings -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Voice Speed</label>
                    <input type="range" id="voice-speed" min="0.5" max="2" step="0.1" value="1" class="w-full" onchange="app.setVoiceSpeed(this.value)" aria-label="Adjust voice reading speed">
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>Slow</span>
                        <span>Fast</span>
                    </div>
                </div>
                
                <!-- Screen Reader Announcements -->
                <div class="flex items-center justify-between">
                    <label for="screen-reader-toggle" class="text-sm font-medium text-gray-700">Enhanced Audio Cues</label>
                    <input type="checkbox" id="screen-reader-toggle" class="rounded" onchange="app.toggleScreenReaderMode()" aria-describedby="screen-reader-desc">
                </div>
                <p id="screen-reader-desc" class="text-xs text-gray-500">Provides additional audio feedback for navigation</p>
                
                <!-- Focus Indicators -->
                <div class="flex items-center justify-between">
                    <label for="focus-indicators-toggle" class="text-sm font-medium text-gray-700">Enhanced Focus</label>
                    <input type="checkbox" id="focus-indicators-toggle" class="rounded" checked onchange="app.toggleFocusIndicators()" aria-describedby="focus-indicators-desc">
                </div>
                <p id="focus-indicators-desc" class="text-xs text-gray-500">Shows clear focus indicators for keyboard navigation</p>
            </div>
            
            <button onclick="app.resetAccessibilitySettings()" class="w-full mt-4 bg-gray-500 text-white py-2 rounded hover:bg-gray-600 text-sm">
                Reset to Defaults
            </button>
        </div>
    </div>

    <!-- Screen reader live region for announcements -->
    <div id="sr-announcements" aria-live="polite" aria-atomic="true" class="sr-only"></div>

    <!-- PWA Installation Banner -->
    <div id="install-banner" class="hidden fixed top-0 left-0 right-0 bg-green-500 text-white p-3 z-50">
        <div class="container mx-auto flex items-center justify-between">
            <div class="flex items-center">
                <i class="fas fa-download mr-2"></i>
                <span>Install Root Cause Power app for better experience!</span>
            </div>
            <div class="flex space-x-2">
                <button id="install-button" class="bg-white text-green-500 px-3 py-1 rounded text-sm font-semibold">Install</button>
                <button id="dismiss-install" class="text-white hover:text-gray-200">✕</button>
            </div>
        </div>
    </div>

    <!-- Voice Credit Counter -->
    <div id="voice-credit-counter" class="fixed top-4 right-4 z-40 bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold cursor-pointer hover:bg-purple-600 transition-colors" onclick="app.showVoiceCreditStore()" title="Buy Voice Credits">
        <i class="fas fa-microphone mr-1"></i><span id="voice-credit-count">0</span> Voice
    </div>

    <!-- Clean Professional Navigation -->
    <nav class="bg-white shadow-lg border-b-2 border-gray-200 fixed w-full top-0 z-30" id="main-nav">
        <div class="container mx-auto px-4">
            <!-- Top Status Bar -->
            <div class="flex justify-between items-center py-2 text-sm border-b border-gray-100">
                <div class="flex items-center space-x-4 text-gray-600">
                    <div class="flex items-center">
                        <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                        <span>AI Connected</span>
                    </div>
                </div>
                <div class="flex items-center space-x-3">
                    <button onclick="app.stopAllAudio()" class="bg-red-500 text-white px-3 py-1 rounded-full text-xs hover:bg-red-600 transition-colors">
                        <i class="fas fa-volume-mute mr-1"></i>Stop Audio
                    </button>
                    <div class="bg-green-500 text-white px-3 py-1 rounded-full text-xs font-bold">
                        5/5 Daily
                    </div>
                    <div class="bg-purple-500 text-white px-3 py-1 rounded-full text-xs font-bold cursor-pointer hover:bg-purple-600 transition-colors" onclick="app.showVoiceCreditStore()">
                        <i class="fas fa-microphone mr-1"></i>0 Voice
                    </div>
                </div>
            </div>

            <!-- Main Navigation Banner -->
            <div class="flex justify-between items-center py-3">
                <!-- Logo (Triple-tap for admin access) -->
                <div id="logo" class="text-xl font-bold text-green-600 flex items-center cursor-pointer" onclick="app.logoTapHandler()">
                    <i class="fas fa-heart mr-2"></i>
                    Root Cause Power
                </div>
                
                <!-- Main 5 Navigation Buttons -->
                <div class="hidden md:flex items-center space-x-6">
                    <button class="nav-btn px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100 hover:text-green-600 transition-all" data-section="assessment">
                        <i class="fas fa-chart-line mr-2"></i>Analysis
                    </button>
                    <button class="nav-btn px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100 hover:text-green-600 transition-all" data-section="dashboard">
                        <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                    </button>
                    <button class="nav-btn px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100 hover:text-green-600 transition-all" data-section="ptsd-corner">
                        <i class="fas fa-shield-heart mr-2"></i>PTSD Corner
                    </button>
                    <button class="nav-btn px-4 py-2 rounded-lg font-medium text-gray-700 hover:bg-gray-100 hover:text-green-600 transition-all" data-section="coaches">
                        <i class="fas fa-robot mr-2"></i>Coaches
                    </button>
                    <button onclick="app.triggerCrisisSupport()" class="bg-red-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-600 transition-all shadow-md">
                        <i class="fas fa-phone mr-2"></i>🚨 Crisis Help
                    </button>
                </div>

                <!-- Hamburger Menu & Mobile Crisis -->
                <div class="flex items-center space-x-3">
                    <!-- Mobile Crisis Button -->
                    <button onclick="app.triggerCrisisSupport()" class="md:hidden bg-red-500 text-white px-3 py-2 rounded-lg text-sm font-semibold hover:bg-red-600 transition-all">
                        🚨
                    </button>
                    
                    <!-- Login Button -->
                    <button id="login-btn" class="bg-green-500 text-white px-4 py-2 rounded-lg hover:bg-green-600 transition-colors" onclick="app.showLoginModal()">
                        Login
                    </button>
                    
                    <!-- Hamburger Menu -->
                    <button id="hamburger-menu-btn" class="text-gray-700 hover:text-green-600 p-2 rounded-lg hover:bg-gray-100 transition-all" onclick="app.toggleHamburgerMenu()">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Dropdown Menu (Hidden by default) -->
        <div id="hamburger-dropdown" class="hidden bg-white border-t border-gray-200 shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="grid md:grid-cols-3 gap-4">
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">Health & Wellness</h3>
                        <div class="space-y-2">
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" data-section="nutrition">
                                <i class="fas fa-apple-alt mr-2"></i>Nutrition
                            </button>
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" data-section="media-library">
                                <i class="fas fa-play-circle mr-2"></i>Media Library
                            </button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">Community</h3>
                        <div class="space-y-2">
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" data-section="community">
                                <i class="fas fa-users mr-2"></i>Community
                            </button>
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" data-section="pricing">
                                <i class="fas fa-credit-card mr-2"></i>Pricing
                            </button>
                        </div>
                    </div>
                    <div>
                        <h3 class="font-semibold text-gray-800 mb-2">Account</h3>
                        <div class="space-y-2">
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" onclick="app.showVoiceCreditStore()">
                                <i class="fas fa-microphone mr-2"></i>Voice Credits
                            </button>
                            <button class="nav-dropdown-item w-full text-left px-3 py-2 text-gray-600 hover:bg-gray-100 hover:text-green-600 rounded transition-all" data-section="help">
                                <i class="fas fa-question-circle mr-2"></i>Help
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main App Container -->
    <div id="app-container" class="pt-24 md:pt-28">
        <main id="main-content" tabindex="-1">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="gradient-bg text-white py-20">
                <div class="container mx-auto text-center px-4">
                    <div class="mb-6">
                        <i class="fas fa-heart text-6xl mb-4 animate-pulse"></i>
                    </div>
                    <h1 class="text-4xl md:text-5xl font-bold mb-4">Root Cause Power</h1>
                    <p class="text-lg md:text-xl mb-8">Discover the root causes of your health challenges with AI-powered lifestyle medicine</p>
                    <p class="text-base md:text-lg mb-8 opacity-90">Created by David Prince, PhD Candidate in Lifestyle Medicine & Clinical Hypnotherapist (CNHC Registered)</p>
                    <button data-section="assessment" class="cta-button bg-white text-blue-600 px-6 md:px-8 py-3 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-colors shadow-lg">Start Your Life Analysis</button>
                </div>
            </div>

            <div class="container mx-auto py-16 px-4">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold mb-4">Combining Science & Wisdom</h2>
                    <p class="text-lg md:text-xl text-gray-600">Our platform integrates Lifestyle Medicine and Clinical Hypnotherapy for comprehensive wellness</p>
                </div>

                <div class="grid md:grid-cols-3 gap-8 mb-16">
                    <div class="feature-card text-center p-6 bg-white rounded-lg shadow-lg hover:shadow-xl transition-shadow">
                        <i class="fas fa-brain text-4xl text-blue-500 mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Lifestyle Medicine</h3>
                        <p class="text-gray-600">Evidence-based approach to preventing and treating chronic diseases through lifestyle interventions</p>
                    </div>
                    <div class="feature-card text-center p-6 bg-white rounded-lg shadow-lg hover:shadow-xl transition-shadow">
                        <i class="fas fa-leaf text-4xl text-green-500 mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Clinical Hypnotherapy</h3>
                        <p class="text-gray-600">Professional therapeutic techniques to address subconscious patterns affecting health</p>
                    </div>
                    <div class="feature-card text-center p-6 bg-white rounded-lg shadow-lg hover:shadow-xl transition-shadow">
                        <i class="fas fa-robot text-4xl text-purple-500 mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">AI Integration</h3>
                        <p class="text-gray-600">Personalized coaching and recommendations powered by advanced artificial intelligence</p>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-white rounded-lg shadow-lg p-8">
                    <h3 class="text-2xl font-bold text-center mb-6">Get Started Now</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <button data-section="assessment" class="quick-action bg-green-100 hover:bg-green-200 text-green-800 p-4 rounded-lg text-center transition-colors">
                            <i class="fas fa-clipboard-list text-2xl mb-2 block"></i>
                            <span class="font-semibold">Take Assessment</span>
                        </button>
                        <button data-section="ptsd-corner" class="quick-action bg-purple-100 hover:bg-purple-200 text-purple-800 p-4 rounded-lg text-center transition-colors">
                            <i class="fas fa-shield-alt text-2xl mb-2 block"></i>
                            <span class="font-semibold">PTSD Support</span>
                        </button>
                        <button data-section="coaches" class="quick-action bg-blue-100 hover:bg-blue-200 text-blue-800 p-4 rounded-lg text-center transition-colors">
                            <i class="fas fa-user-md text-2xl mb-2 block"></i>
                            <span class="font-semibold">AI Coaches</span>
                        </button>
                        <button data-section="media-library" class="quick-action bg-orange-100 hover:bg-orange-200 text-orange-800 p-4 rounded-lg text-center transition-colors">
                            <i class="fas fa-play-circle text-2xl mb-2 block"></i>
                            <span class="font-semibold">Media Library</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Intelligent Analysis Section -->
        <section id="assessment" class="section hidden">
            <div class="container mx-auto py-8 px-4">
                <!-- Safety & Care Message -->
                <div class="bg-gradient-to-r from-blue-50 to-purple-50 border-l-4 border-purple-500 p-6 mb-8 rounded-lg">
                    <div class="flex items-start">
                        <div class="flex-shrink-0">
                            <i class="fas fa-shield-heart text-purple-500 text-2xl"></i>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-semibold text-purple-800 mb-2">You're in Safe Hands</h4>
                            <p class="text-sm text-purple-700 leading-relaxed">
                                This intelligent analysis is designed by experts in trauma recovery and lifestyle medicine. 
                                <strong>If you're in crisis right now</strong>, please reach out to emergency services or call a crisis helpline immediately. 
                                Your safety and wellbeing are our top priority.
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Welcome Header -->
                <div class="text-center mb-12">
                    <div class="inline-flex items-center justify-center w-20 h-20 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full mb-4">
                        <i class="fas fa-brain text-white text-3xl"></i>
                    </div>
                    <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-4">
                        Your Intelligent Life Analysis
                    </h1>
                    <p class="text-xl text-gray-600 mb-3">A personalized journey designed specifically for you</p>
                    <p class="text-lg text-purple-600 font-semibold bg-purple-100 px-6 py-2 rounded-full inline-block">
                        ✨ 10 thoughtful steps to understanding your path forward
                    </p>
                </div>

                <!-- Main Analysis Container -->
                <div id="assessment-container" class="max-w-5xl mx-auto">
                    <!-- Progress Section -->
                    <div class="bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg shadow-xl p-6 mb-8 text-white">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-xl font-semibold flex items-center">
                                <i class="fas fa-route mr-2"></i>
                                Your Journey Progress
                            </h3>
                            <span id="step-indicator" class="text-sm bg-white bg-opacity-20 px-4 py-2 rounded-full font-semibold">
                                Step <span id="current-step">1</span> of 10
                            </span>
                        </div>
                        <div class="w-full bg-white bg-opacity-20 rounded-full h-4 mb-3">
                            <div id="progress-bar" class="bg-gradient-to-r from-yellow-400 to-green-400 h-4 rounded-full transition-all duration-700 flex items-center justify-end pr-2" style="width: 10%;">
                                <i class="fas fa-star text-white text-xs animate-pulse"></i>
                            </div>
                        </div>
                        <div id="progress-message" class="text-sm opacity-95 italic">
                            🌟 Every step brings you closer to understanding yourself better...
                        </div>
                    </div>

                    <!-- AI Analysis Interface -->
                    <div class="bg-white rounded-xl shadow-2xl overflow-hidden border border-gray-100">
                        <!-- AI Avatar Header -->
                        <div class="bg-gradient-to-r from-purple-50 to-blue-50 p-6 border-b border-gray-100">
                            <div class="flex items-center">
                                <div class="w-16 h-16 bg-gradient-to-br from-purple-400 to-blue-500 rounded-full flex items-center justify-center text-white text-2xl mr-4 shadow-lg">
                                    <i class="fas fa-user-md"></i>
                                </div>
                                <div class="flex-1">
                                    <h3 class="text-2xl font-bold text-gray-800">Coach Sarah</h3>
                                    <p class="text-gray-600 mb-1">Your AI Wellness Analyst</p>
                                    <div class="flex items-center text-sm text-green-600">
                                        <i class="fas fa-circle text-xs mr-2 animate-pulse"></i>
                                        Active and listening
                                    </div>
                                </div>
                                <div class="text-right">
                                    <div class="text-sm text-gray-500">Powered by</div>
                                    <div class="text-lg font-bold text-purple-600">Advanced AI</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Analysis Content Area -->
                        <div class="p-8">
                            <div id="assessment-questions" class="min-h-64">
                                <!-- Dynamic content will be inserted here -->
                            </div>
                        </div>
                        
                        <!-- Navigation Footer -->
                        <div class="bg-gray-50 p-6 flex justify-between items-center border-t border-gray-100">
                            <button id="prev-btn" class="bg-gray-500 text-white px-8 py-3 rounded-lg hover:bg-gray-600 transition-all duration-200 disabled:opacity-50 flex items-center" disabled>
                                <i class="fas fa-chevron-left mr-2"></i>
                                Previous
                            </button>
                            <div class="text-center">
                                <div id="step-info" class="text-sm text-gray-500 mb-1">Moving at your own pace</div>
                                <div class="text-xs text-gray-400">Take your time - there's no rush</div>
                            </div>
                            <button id="next-btn" class="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-8 py-3 rounded-lg hover:from-purple-600 hover:to-blue-600 transition-all duration-200 flex items-center shadow-lg">
                                Continue
                                <i class="fas fa-chevron-right ml-2"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Encouragement & Support -->
                    <div class="mt-8 grid md:grid-cols-2 gap-6">
                        <div class="bg-green-50 p-6 rounded-lg border border-green-200">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-heart text-red-500 text-xl mr-3"></i>
                                <h4 class="font-semibold text-green-800">You're Not Alone</h4>
                            </div>
                            <p class="text-green-700 text-sm">
                                Every answer helps us understand how to support you better. You're taking a courageous step toward healing and growth.
                            </p>
                        </div>
                        <div class="bg-blue-50 p-6 rounded-lg border border-blue-200">
                            <div class="flex items-center mb-3">
                                <i class="fas fa-shield-alt text-blue-500 text-xl mr-3"></i>
                                <h4 class="font-semibold text-blue-800">Safe & Confidential</h4>
                            </div>
                            <p class="text-blue-700 text-sm">
                                Your responses are completely private and secure. We use advanced encryption to protect your personal information.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- AI Coaches Section -->
        <section id="coaches" class="section hidden">
            <div class="container mx-auto py-8 px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-8">Your AI Health Specialists</h2>
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-green-400 to-green-600" data-coach="nutrition">
                        <i class="fas fa-apple-alt text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Nutrition Coach</h3>
                        <p>Personalized meal plans and nutritional guidance based on your assessment results</p>
                    </div>
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-blue-400 to-blue-600" data-coach="sleep">
                        <i class="fas fa-bed text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Sleep Specialist</h3>
                        <p>Optimize your sleep patterns and recovery for better health outcomes</p>
                    </div>
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-purple-400 to-purple-600" data-coach="stress">
                        <i class="fas fa-spa text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Stress Management</h3>
                        <p>Techniques and strategies to manage stress and improve mental wellbeing</p>
                    </div>
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-orange-400 to-orange-600" data-coach="fitness">
                        <i class="fas fa-dumbbell text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Fitness Coach</h3>
                        <p>Customized exercise programs tailored to your fitness level and goals</p>
                    </div>
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-pink-400 to-pink-600" data-coach="supplements">
                        <i class="fas fa-pills text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">Supplement Advisor</h3>
                        <p>Evidence-based supplement recommendations for your specific health needs</p>
                    </div>
                    <div class="coach-card text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 bg-gradient-to-br from-red-400 to-red-600" data-coach="ptsd">
                        <i class="fas fa-heart text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">PTSD Specialist</h3>
                        <p>Specialized support for PTSD, CPTSD, and trauma recovery with 24/7 availability</p>
                    </div>
                    <div class="bg-gradient-to-br from-purple-600 to-blue-600 text-white p-6 rounded-lg shadow-lg cursor-pointer hover:shadow-xl transition-all transform hover:scale-105 relative" onclick="app.openVoiceAI()">
                        <div class="absolute top-2 right-2 bg-yellow-400 text-black px-2 py-1 rounded-full text-xs font-bold">NEW!</div>
                        <i class="fas fa-microphone text-4xl mb-4"></i>
                        <h3 class="text-xl font-bold mb-2">🎤 Voice AI Coach</h3>
                        <p>Emotionally intelligent voice coaching powered by advanced AI - talk naturally and get empathetic responses</p>
                        <div class="mt-3 text-sm bg-white bg-opacity-20 p-2 rounded">
                            <i class="fas fa-bolt mr-1"></i>Uses voice credits • Natural conversation
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="section hidden">
            <!-- Hero Welcome Section -->
            <div class="bg-gradient-to-br from-purple-600 via-blue-600 to-green-500 text-white relative overflow-hidden">
                <div class="absolute inset-0 bg-black bg-opacity-20"></div>
                <div class="relative container mx-auto py-16 px-4 text-center">
                    <div class="inline-flex items-center justify-center w-24 h-24 bg-white bg-opacity-20 rounded-full mb-6 animate-pulse">
                        <i class="fas fa-star text-4xl text-yellow-300"></i>
                    </div>
                    <h1 class="text-4xl md:text-6xl font-bold mb-4" id="dashboard-greeting">Welcome Back, Champion! 🌟</h1>
                    <p class="text-xl md:text-2xl mb-6 opacity-95" id="motivational-message">You're making incredible progress on your healing journey</p>
                    <div class="bg-white bg-opacity-20 rounded-lg p-6 backdrop-blur-sm max-w-2xl mx-auto">
                        <div class="flex items-center justify-center space-x-6">
                            <div class="text-center">
                                <div class="text-3xl font-bold" id="days-since-start">12</div>
                                <div class="text-sm opacity-90">Days Strong</div>
                            </div>
                            <div class="w-px h-12 bg-white bg-opacity-30"></div>
                            <div class="text-center">
                                <div class="text-3xl font-bold" id="total-progress">78%</div>
                                <div class="text-sm opacity-90">Journey Complete</div>
                            </div>
                            <div class="w-px h-12 bg-white bg-opacity-30"></div>
                            <div class="text-center">
                                <div class="text-3xl font-bold" id="achievements-count">5</div>
                                <div class="text-sm opacity-90">Achievements</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="container mx-auto py-8 px-4">
                <!-- 🎉 REVOLUTIONARY VOICE COACH -->
                <div class="bg-gradient-to-r from-purple-600 via-pink-600 to-indigo-600 rounded-2xl shadow-2xl p-8 mb-8 text-white relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white bg-opacity-10 rounded-full -mr-16 -mt-16"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-white bg-opacity-10 rounded-full -ml-12 -mb-12"></div>
                    
                    <div class="relative z-10">
                        <div class="flex items-center justify-between mb-6">
                            <div>
                                <div class="flex items-center mb-3">
                                    <i class="fas fa-microphone-alt text-4xl mr-4 text-yellow-300"></i>
                                    <div>
                                        <h2 class="text-3xl font-bold mb-1">🧠 Revolutionary PTSD Voice Coach</h2>
                                        <p class="text-purple-100">World's first emotionally intelligent voice companion</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-6 text-sm">
                                    <div class="flex items-center">
                                        <i class="fas fa-check-circle text-green-300 mr-2"></i>
                                        <span>Crisis Detection Active</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-heart text-pink-300 mr-2"></i>
                                        <span>Trauma-Informed AI</span>
                                    </div>
                                    <div class="flex items-center">
                                        <i class="fas fa-comments text-blue-300 mr-2"></i>
                                        <span>True Voice Conversation</span>
                                    </div>
                                </div>
                            </div>
                            <button onclick="app.openVoiceCoach()" 
                                    class="bg-white text-purple-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-purple-50 transition-all duration-300 shadow-lg transform hover:scale-105">
                                <i class="fas fa-microphone mr-3"></i>Start Voice Chat
                            </button>
                        </div>
                        
                        <div class="grid md:grid-cols-4 gap-4 text-center">
                            <div class="bg-white bg-opacity-10 rounded-lg p-4">
                                <i class="fas fa-brain text-2xl mb-2 text-yellow-300"></i>
                                <div class="font-semibold">AI Empathy</div>
                                <div class="text-xs opacity-90">Emotional Intelligence</div>
                            </div>
                            <div class="bg-white bg-opacity-10 rounded-lg p-4">
                                <i class="fas fa-shield-alt text-2xl mb-2 text-green-300"></i>
                                <div class="font-semibold">Crisis Support</div>
                                <div class="text-xs opacity-90">24/7 Monitoring</div>
                            </div>
                            <div class="bg-white bg-opacity-10 rounded-lg p-4">
                                <i class="fas fa-leaf text-2xl mb-2 text-blue-300"></i>
                                <div class="font-semibold">Grounding</div>
                                <div class="text-xs opacity-90">Voice-Activated</div>
                            </div>
                            <div class="bg-white bg-opacity-10 rounded-lg p-4">
                                <i class="fas fa-clock text-2xl mb-2 text-pink-300"></i>
                                <div class="font-semibold">Always Here</div>
                                <div class="text-xs opacity-90">24/7 Available</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
                    <h3 class="text-2xl font-bold mb-6 text-gray-800 flex items-center">
                        <i class="fas fa-bolt text-yellow-500 mr-3"></i>
                        Quick Actions
                    </h3>
                    <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                        <!-- 🎉 REVOLUTIONARY VOICE COACH -->
                        <button onclick="app.openVoiceCoach()" class="quick-action-btn bg-gradient-to-br from-purple-500 to-pink-500 text-white p-4 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all duration-200 text-center relative shadow-xl">
                            <div class="absolute -top-2 -right-2 bg-green-400 text-green-900 text-xs font-bold px-2 py-1 rounded-full animate-pulse">
                                ✅ VOICE!
                            </div>
                            <i class="fas fa-microphone-alt text-2xl mb-2 block"></i>
                            <div class="font-semibold text-sm">🎙️ Voice Coach</div>
                            <div class="text-xs opacity-90">Speak & Listen</div>
                        </button>
                        
                        <button id="quick-checkin-btn" class="quick-action-btn bg-gradient-to-br from-green-400 to-green-600 text-white p-4 rounded-lg hover:from-green-500 hover:to-green-700 transition-all duration-200 text-center">
                            <i class="fas fa-comments text-2xl mb-2 block"></i>
                            <div class="font-semibold text-sm">Quick AI Chat</div>
                        </button>
                        <button data-section="coaches" class="quick-action-btn bg-gradient-to-br from-purple-400 to-purple-600 text-white p-4 rounded-lg hover:from-purple-500 hover:to-purple-700 transition-all duration-200 text-center">
                            <i class="fas fa-user-md text-2xl mb-2 block"></i>
                            <div class="font-semibold text-sm">Meet Coaches</div>
                        </button>
                        <button data-section="ptsd-corner" class="quick-action-btn bg-gradient-to-br from-pink-400 to-pink-600 text-white p-4 rounded-lg hover:from-pink-500 hover:to-pink-700 transition-all duration-200 text-center">
                            <i class="fas fa-heart text-2xl mb-2 block"></i>
                            <div class="font-semibold text-sm">PTSD Support</div>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- PTSD Corner Section -->
        <section id="ptsd-corner" class="section hidden">
            <div class="container mx-auto py-8 px-4">
                <!-- Crisis Resources Banner -->
                <div class="bg-gradient-to-r from-red-500 to-pink-500 text-white rounded-lg p-6 mb-8 text-center">
                    <h2 class="text-2xl font-bold mb-4">🚨 Crisis Resources Available 24/7</h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        <div>
                            <strong>UK: Samaritans</strong><br>
                            <a href="tel:116123" class="text-blue-100 font-bold">116 123</a>
                        </div>
                        <div>
                            <strong>US: Crisis Lifeline</strong><br>
                            <a href="tel:988" class="text-blue-100 font-bold">988</a>
                        </div>
                        <div>
                            <strong>Emergency Services</strong><br>
                            <a href="tel:999" class="text-yellow-100 font-bold">999 (UK) / 911 (US)</a>
                        </div>
                    </div>
                </div>

                <h2 class="text-3xl md:text-4xl font-bold text-center mb-8">🛡️ PTSD Corner - Safe Space</h2>
                
                <!-- Coping Techniques -->
                <div class="bg-white rounded-lg shadow-lg p-8 mb-8">
                    <h3 class="text-2xl font-bold mb-6">🌱 Coping Techniques</h3>
                    <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                        <div class="coping-technique bg-blue-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all transform hover:scale-105" data-technique="grounding">
                            <h4 class="font-bold mb-2">5-4-3-2-1 Grounding</h4>
                            <p class="text-sm text-gray-600">Use your senses to stay present</p>
                        </div>
                        <div class="coping-technique bg-green-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all transform hover:scale-105" data-technique="breathing">
                            <h4 class="font-bold mb-2">Box Breathing</h4>
                            <p class="text-sm text-gray-600">Calm your nervous system</p>
                        </div>
                        <div class="coping-technique bg-purple-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all transform hover:scale-105" data-technique="relaxation">
                            <h4 class="font-bold mb-2">Progressive Relaxation</h4>
                            <p class="text-sm text-gray-600">Release physical tension</p>
                        </div>
                        <div class="coping-technique bg-pink-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all transform hover:scale-105" data-technique="emdr">
                            <h4 class="font-bold mb-2">EMDR Self-Help</h4>
                            <p class="text-sm text-gray-600">Bilateral stimulation techniques</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pricing Section -->
        <section id="pricing" class="section hidden">
            <div class="container mx-auto py-8 px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-8">Membership & Voice Credits</h2>
                <div class="text-center mb-8">
                    <p class="text-lg text-gray-600">Choose the plan that best supports your healing journey</p>
                </div>
                
                <!-- Pricing Tiers -->
                <div class="grid md:grid-cols-3 gap-8 mb-12">
                    <!-- Free Plan -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-gray-200">
                        <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold mb-2">Free Access</h3>
                            <div class="text-4xl font-bold text-green-500 mb-2">£0</div>
                            <p class="text-gray-600">Essential PTSD support</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>5 AI coach interactions daily</li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>Basic PTSD assessment</li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>EMDR self-help techniques</li>
                            <li class="flex items-center"><i class="fas fa-check text-green-500 mr-2"></i>Crisis support (24/7)</li>
                            <li class="flex items-center"><i class="fas fa-times text-red-500 mr-2"></i>Voice AI coaching sessions</li>
                        </ul>
                        <button class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors" onclick="app.selectPlan('free')">
                            Get Started Free
                        </button>
                    </div>
                    
                    <!-- Standard Plan -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-blue-500 relative">
                        <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-4 py-1 rounded-full text-sm font-bold">
                            Most Popular
                        </div>
                        <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold mb-2">Standard</h3>
                            <div class="text-4xl font-bold text-blue-500 mb-2">£29<span class="text-lg">/month</span></div>
                            <p class="text-gray-600">Complete trauma recovery support</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center"><i class="fas fa-check text-blue-500 mr-2"></i>Unlimited AI coach interactions</li>
                            <li class="flex items-center"><i class="fas fa-check text-blue-500 mr-2"></i>Advanced PTSD assessments</li>
                            <li class="flex items-center"><i class="fas fa-check text-blue-500 mr-2"></i>5 voice AI sessions/month included</li>
                            <li class="flex items-center"><i class="fas fa-check text-blue-500 mr-2"></i>Priority crisis support</li>
                            <li class="flex items-center"><i class="fas fa-check text-blue-500 mr-2"></i>Additional voice sessions: £7.99 each</li>
                        </ul>
                        <button class="w-full bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors" onclick="app.selectPlan('standard')">
                            Choose Standard
                        </button>
                    </div>
                    
                    <!-- Premium Plan -->
                    <div class="bg-white rounded-lg shadow-lg p-6 border-2 border-purple-500">
                        <div class="text-center mb-6">
                            <h3 class="text-2xl font-bold mb-2">Premium</h3>
                            <div class="text-4xl font-bold text-purple-500 mb-2">£49<span class="text-lg">/month</span></div>
                            <p class="text-gray-600">Unlimited healing ecosystem</p>
                        </div>
                        <ul class="space-y-3 mb-6">
                            <li class="flex items-center"><i class="fas fa-check text-purple-500 mr-2"></i>Everything in Standard</li>
                            <li class="flex items-center"><i class="fas fa-check text-purple-500 mr-2"></i>Unlimited voice AI sessions</li>
                            <li class="flex items-center"><i class="fas fa-check text-purple-500 mr-2"></i>Advanced EMDR protocols</li>
                            <li class="flex items-center"><i class="fas fa-check text-purple-500 mr-2"></i>Priority phone support</li>
                            <li class="flex items-center"><i class="fas fa-check text-purple-500 mr-2"></i>Family/caregiver access</li>
                        </ul>
                        <button class="w-full bg-purple-500 text-white py-3 rounded-lg hover:bg-purple-600 transition-colors" onclick="app.selectPlan('premium')">
                            Choose Premium
                        </button>
                    </div>
                </div>

                <!-- Voice Credits Section -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-8">
                    <h3 class="text-2xl font-bold mb-4 text-center">🎤 Voice AI Credits</h3>
                    <p class="text-center text-gray-600 mb-6">Additional voice coaching sessions for Standard members</p>
                    
                    <div class="grid md:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md text-center">
                            <h4 class="text-xl font-bold mb-2">1 Session</h4>
                            <div class="text-3xl font-bold text-purple-600 mb-2">£7.99</div>
                            <p class="text-sm text-gray-600 mb-4">Single voice coaching session</p>
                            <button class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors" onclick="app.buyVoiceCredits(1, 7.99)">
                                Purchase
                            </button>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md text-center border-2 border-purple-500">
                            <div class="text-sm bg-purple-500 text-white px-2 py-1 rounded-full mb-2">Best Value</div>
                            <h4 class="text-xl font-bold mb-2">5 Sessions</h4>
                            <div class="text-3xl font-bold text-purple-600 mb-2">£29.99</div>
                            <p class="text-sm text-gray-600 mb-4">Save £10 • £6 per session</p>
                            <button class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors" onclick="app.buyVoiceCredits(5, 29.99)">
                                Purchase
                            </button>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-md text-center">
                            <h4 class="text-xl font-bold mb-2">10 Sessions</h4>
                            <div class="text-3xl font-bold text-purple-600 mb-2">£49.99</div>
                            <p class="text-sm text-gray-600 mb-4">Save £30 • £5 per session</p>
                            <button class="w-full bg-purple-500 text-white py-2 rounded-lg hover:bg-purple-600 transition-colors" onclick="app.buyVoiceCredits(10, 49.99)">
                                Purchase
                            </button>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-white rounded-lg">
                        <p class="text-sm text-gray-600 text-center">
                            <i class="fas fa-info-circle mr-2"></i>
                            Voice credits never expire and work with our revolutionary empathic AI voice coach
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Other sections (nutrition, media-library, community, help) can be added back if needed -->

    </div>

    <!-- Modals -->
    <div id="login-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg max-w-md w-full mx-4">
            <h2 class="text-2xl font-bold mb-6">Login to Root Cause Power</h2>
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                    <input type="email" id="login-email" placeholder="your@email.com" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" required>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="login-password" placeholder="Your password" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" required>
                </div>
                <button type="submit" class="w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors font-semibold">
                    Login
                </button>
                <div class="text-center">
                    <p class="text-sm text-gray-600">Test with: david@fuelgeist.co.uk / Founder-1!</p>
                </div>
            </form>
            <button class="close-modal mt-4 text-gray-500 hover:text-gray-700" onclick="app.closeModal('login-modal')">Close</button>
        </div>
    </div>

    <div id="voice-credit-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg max-w-lg w-full mx-4">
            <h2 class="text-2xl font-bold mb-6">🎤 Purchase Voice Credits</h2>
            <div class="space-y-4">
                <div class="bg-purple-50 p-4 rounded-lg">
                    <h3 class="font-bold text-purple-800 mb-2">Revolutionary Voice AI</h3>
                    <p class="text-sm text-purple-700">Experience the world's first emotionally intelligent PTSD voice coach. Natural conversation with crisis detection built-in.</p>
                </div>
                
                <div class="grid grid-cols-3 gap-4" id="voice-credit-options">
                    <!-- Voice credit options will be inserted here -->
                </div>
                
                <div class="border-t pt-4">
                    <div class="flex justify-between items-center">
                        <span class="font-semibold">Total:</span>
                        <span class="text-2xl font-bold text-purple-600" id="credit-total">£0.00</span>
                    </div>
                </div>
                
                <button id="purchase-credits-btn" class="w-full bg-purple-500 text-white py-3 rounded-lg hover:bg-purple-600 transition-colors font-semibold disabled:opacity-50" disabled>
                    Purchase Voice Credits
                </button>
            </div>
            <button class="close-modal mt-4 text-gray-500 hover:text-gray-700" onclick="app.closeModal('voice-credit-modal')">Close</button>
        </div>
    </div>

    <div id="coach-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg max-w-4xl w-full mx-4 max-h-[85vh] flex flex-col">
            <div class="flex justify-between items-center mb-4 border-b pb-3">
                <h2 class="text-xl font-bold">AI Coach Chat</h2>
                <button class="close-modal text-gray-500 hover:text-gray-700 text-xl" onclick="app.closeModal('coach-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="coach-content" class="flex-1 overflow-hidden"></div>
        </div>
    </div>

    <div id="technique-modal" class="modal fixed inset-0 bg-black bg-opacity-50 items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg max-w-2xl w-full mx-4">
            <div id="technique-content"></div>
            <button class="close-modal mt-4 text-gray-500 hover:text-gray-700" onclick="app.closeModal('technique-modal')">Close</button>
        </div>
    </div>

    <div id="emdr-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg max-w-4xl w-full mx-4 max-h-[85vh] overflow-y-auto">
            <div id="emdr-content">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold">EMDR Self-Help Techniques</h2>
                    <button class="close-modal text-gray-500 hover:text-gray-700 text-xl" onclick="app.closeModal('emdr-modal')">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="emdr-technique bg-blue-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all" data-emdr="butterfly">
                        <h4 class="font-bold mb-2">🦋 Butterfly Hug</h4>
                        <p class="text-sm">Cross arms over chest and gently tap alternating shoulders</p>
                    </div>
                    <div class="emdr-technique bg-green-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all" data-emdr="eyes">
                        <h4 class="font-bold mb-2">👁️ Eye Movements</h4>
                        <p class="text-sm">Follow the moving dot with your eyes while processing</p>
                    </div>
                    <div class="emdr-technique bg-purple-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all" data-emdr="audio">
                        <h4 class="font-bold mb-2">🎵 Auditory BLS</h4>
                        <p class="text-sm">Listen to alternating sounds while focusing on memory</p>
                    </div>
                    <div class="emdr-technique bg-pink-100 p-4 rounded-lg cursor-pointer hover:shadow-lg transition-all" data-emdr="tactile">
                        <h4 class="font-bold mb-2">👋 Tactile BLS</h4>
                        <p class="text-sm">Alternate tapping knees or holding buzzers</p>
                    </div>
                </div>
                <div id="emdr-exercise" class="mt-6 p-4 bg-gray-50 rounded-lg hidden">
                    <div id="emdr-instructions"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hume AI Voice Modal -->
    <div id="voice-ai-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg max-w-2xl w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">🎤 Voice AI Coach</h2>
                <button class="close-modal text-gray-500 hover:text-gray-700 text-xl" onclick="app.closeModal('voice-ai-modal')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div id="voice-ai-content" class="text-center">
                <!-- Voice AI interface will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="./js/hume-voice-integration.js?v=1.0.0"></script>
    <script src="./js/app.js?v=2.0.0"></script>
    
    <!-- PWA Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <!-- Emergency EMDR & Assessment System -->
    <script>
        // Working EMDR functionality while main app.js loads
        window.EMDRHelper = {
            currentAudio: null,
            
            playBinauralTone: function(ear) {
                console.log('🎵 Playing binaural tone for', ear, 'ear');
                const audioFile = ear === 'left' ? 'audio/bilateral-tones-left.wav' : 'audio/bilateral-tones-right.wav';
                this.playTherapeuticAudio(audioFile);
            },
            
            startAlternatingTones: function() {
                console.log('🔄 Starting alternating EMDR tones');
                this.playTherapeuticAudio('audio/alternating-chimes.wav', false);
                
                const button = event.target;
                const originalText = button.innerHTML;
                button.innerHTML = '🎵 Playing... <span class="text-xs">(10 minutes)</span>';
                button.disabled = true;
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 600000);
            },
            
            startEyeMovementAnimation: function() {
                console.log('👁️ Starting eye movement animation');
                const dot = document.getElementById('moving-dot');
                const track = document.getElementById('eye-movement-track');
                
                if (!dot || !track) {
                    console.error('❌ Eye movement elements not found');
                    alert('Eye movement elements not ready. Please try selecting the Eye Movement technique again.');
                    return;
                }
                
                console.log('✅ Starting animation - elements found');
                const trackWidth = track.offsetWidth - 16;
                let position = 0;
                let direction = 1;
                let cycles = 0;
                const maxCycles = 15;
                
                dot.classList.remove('bg-green-500');
                dot.classList.add('bg-blue-500');
                dot.style.transform = 'none';
                
                const animate = () => {
                    position += direction * 3;
                    
                    if (position >= trackWidth || position <= 0) {
                        direction *= -1;
                        cycles++;
                        
                        if (cycles >= maxCycles) {
                            dot.style.left = '50%';
                            dot.style.transform = 'translateX(-50%)';
                            dot.classList.add('bg-green-500');
                            dot.classList.remove('bg-blue-500');
                            console.log('✅ Eye movement completed!');
                            return;
                        }
                    }
                    
                    dot.style.left = position + 'px';
                    requestAnimationFrame(animate);
                };
                
                animate();
            },
            
            playTherapeuticAudio: function(audioPath, loop = false) {
                try {
                    console.log('🎵 Starting audio:', audioPath);
                    
                    if (this.currentAudio) {
                        this.currentAudio.pause();
                        this.currentAudio.currentTime = 0;
                    }
                    
                    this.currentAudio = new Audio(audioPath);
                    this.currentAudio.volume = 0.7;
                    this.currentAudio.loop = loop;
                    
                    this.currentAudio.play().then(() => {
                        console.log('✅ Audio playing:', audioPath);
                    }).catch(error => {
                        console.error('❌ Audio failed:', error);
                        alert('Click anywhere first to enable audio, then try again.');
                    });
                } catch (error) {
                    console.error('❌ Audio error:', error);
                    alert('Audio not available. Please check your browser settings.');
                }
            },

            startEMDRTechnique: function(emdrType) {
                console.log('🎯 Starting EMDR technique:', emdrType);
                const exerciseDiv = document.getElementById('emdr-exercise');
                const instructionsDiv = document.getElementById('emdr-instructions');
                
                if (!exerciseDiv || !instructionsDiv) {
                    console.error('❌ EMDR elements not found');
                    return;
                }
                
                exerciseDiv.classList.remove('hidden');
                
                switch(emdrType) {
                    case 'butterfly':
                        this.startButterflyHug(instructionsDiv);
                        break;
                    case 'eyes':
                        this.startEyeMovements(instructionsDiv);
                        break;
                    case 'audio':
                        this.startAuditoryBLS(instructionsDiv);
                        break;
                    case 'tactile':
                        this.startTactileBLS(instructionsDiv);
                        break;
                    default:
                        console.error('❌ Unknown EMDR technique:', emdrType);
                }
            },

            startButterflyHug: function(container) {
                container.innerHTML = `
                    <h4 class="font-bold mb-3">🦋 Butterfly Hug Technique</h4>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-4 mb-4">
                            <div class="text-4xl">🤗</div>
                            <div>
                                <p class="font-medium">Step-by-step instructions:</p>
                            </div>
                        </div>
                        <div class="space-y-2 text-sm">
                            <p><strong>1.</strong> Cross your arms over your chest, like giving yourself a hug</p>
                            <p><strong>2.</strong> Place your hands on your shoulders (right hand on left shoulder, left hand on right shoulder)</p>
                            <p><strong>3.</strong> Gently tap alternating shoulders: left, right, left, right...</p>
                            <p><strong>4.</strong> Continue for 30-60 seconds while breathing naturally</p>
                            <p><strong>5.</strong> Think of something positive or just focus on the tapping sensation</p>
                        </div>
                        <div class="mt-4 p-3 bg-blue-50 rounded">
                            <p class="text-sm"><strong>Benefits:</strong> This creates bilateral stimulation which can help process emotions and create a sense of safety and self-soothing.</p>
                        </div>
                        <div class="mt-4 p-3 bg-green-50 rounded">
                            <p class="text-sm text-green-700"><strong>Remember:</strong> You are giving yourself compassion and care. You deserve this kindness.</p>
                        </div>
                    </div>
                `;
            },

            startEyeMovements: function(container) {
                container.innerHTML = `
                    <h4 class="font-bold mb-3">👁️ Eye Movement Technique</h4>
                    <div class="text-center mb-4">
                        <div class="w-full h-20 bg-gray-100 rounded relative overflow-hidden" id="eye-movement-track">
                            <div class="w-4 h-4 bg-blue-500 rounded-full absolute top-8 transition-all duration-2000" id="moving-dot" style="left: 10px;"></div>
                        </div>
                    </div>
                    <div class="space-y-2 text-sm">
                        <p><strong>Instructions:</strong></p>
                        <p>• Follow the moving dot with your eyes only (don't move your head)</p>
                        <p>• While following the dot, think of a mildly positive memory or just focus on the movement</p>
                        <p>• Continue for 30 seconds, then take a break</p>
                        <p>• Notice any changes in how you feel</p>
                    </div>
                    <button onclick="EMDRHelper.startEyeMovementAnimation()" class="mt-4 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors">Start Eye Movement</button>
                    <div class="mt-4 p-3 bg-yellow-50 rounded">
                        <p class="text-xs"><strong>Note:</strong> Start with positive or neutral memories. If you feel overwhelmed, stop and use grounding techniques.</p>
                    </div>
                `;
            },

            startAuditoryBLS: function(container) {
                container.innerHTML = `
                    <h4 class="font-bold mb-3">🎵 Auditory Bilateral Stimulation</h4>
                    <div class="space-y-4">
                        <p class="text-sm">This technique uses alternating sounds to create bilateral stimulation:</p>
                        
                        <div class="bg-blue-50 p-3 rounded-lg mb-4">
                            <p class="text-xs text-blue-700"><strong>🎧 Instructions:</strong> Use headphones for best effect. Click any button below to start.</p>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="EMDRHelper.playBinauralTone('left')" class="bg-blue-500 text-white p-4 rounded hover:bg-blue-600 transition-colors">
                                🎧 Left Ear<br><span class="text-xs">Play tone</span>
                            </button>
                            <button onclick="EMDRHelper.playBinauralTone('right')" class="bg-green-500 text-white p-4 rounded hover:bg-green-600 transition-colors">
                                🎧 Right Ear<br><span class="text-xs">Play tone</span>
                            </button>
                        </div>
                        <button onclick="EMDRHelper.startAlternatingTones()" class="w-full bg-purple-500 text-white p-3 rounded hover:bg-purple-600 transition-colors">
                            🔄 Start Professional EMDR Audio (10 min)
                        </button>
                        <div class="space-y-1 text-xs text-gray-600">
                            <p><strong>Instructions:</strong></p>
                            <p>• Use headphones for best effect</p>
                            <p>• Focus on something positive while listening</p>
                            <p>• Let the alternating sounds help process emotions</p>
                            <p>• Continue for 2-3 minutes or until you feel calmer</p>
                        </div>
                    </div>
                `;
            },

            startTactileBLS: function(container) {
                container.innerHTML = `
                    <h4 class="font-bold mb-3">👋 Tactile Bilateral Stimulation</h4>
                    <div class="space-y-4">
                        <p class="text-sm">Use touch to create bilateral stimulation:</p>
                        
                        <div class="bg-blue-50 p-4 rounded">
                            <p class="font-medium mb-2">🦵 Knee Tapping Method:</p>
                            <div class="space-y-1 text-sm">
                                <p>• Sit comfortably and place hands on knees</p>
                                <p>• Alternate tapping left knee, then right knee</p>
                                <p>• Maintain steady rhythm (about 1 tap per second)</p>
                                <p>• Continue for 1-2 minutes while breathing deeply</p>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded">
                            <p class="font-medium mb-2">🤗 Self-Hug Tapping:</p>
                            <div class="space-y-1 text-sm">
                                <p>• Cross arms and place hands on opposite shoulders</p>
                                <p>• Gently pat alternating shoulders</p>
                                <p>• Focus on something calming while tapping</p>
                                <p>• This combines bilateral stimulation with self-soothing</p>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 p-4 rounded">
                            <p class="font-medium mb-2">📱 Using Your Phone:</p>
                            <div class="space-y-1 text-sm">
                                <p>• Hold your phone in alternating hands</p>
                                <p>• Set it to vibrate and pass it left-right-left-right</p>
                                <p>• Or use EMDR apps with bilateral vibration</p>
                            </div>
                        </div>
                        
                        <div class="text-center p-3 bg-purple-50 rounded">
                            <p class="text-sm text-purple-700 font-medium">Remember: Go at your own pace. Stop if you feel overwhelmed.</p>
                        </div>
                    </div>
                `;
            }
        };

        // Modal functionality
        window.openModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('hidden');
                console.log('✅ Modal opened:', modalId);
            }
        };
        
        window.closeModal = function(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.add('hidden');
                console.log('✅ Modal closed:', modalId);
            }
        };

        // Make functions globally accessible
        window.app = window.app || {};
        window.app.playBinauralTone = function(ear) { EMDRHelper.playBinauralTone(ear); };
        window.app.startAlternatingTones = function() { EMDRHelper.startAlternatingTones(); };
        window.app.startEyeMovementAnimation = function() { EMDRHelper.startEyeMovementAnimation(); };
        window.app.openModal = window.openModal;
        window.app.closeModal = window.closeModal;

        // Handle EMDR clicks
        document.addEventListener('click', function(e) {
            if (e.target.matches('[data-technique="emdr"]') || e.target.closest('[data-technique="emdr"]')) {
                console.log('🎯 EMDR technique clicked');
                window.openModal('emdr-modal');
            }
            
            if (e.target.matches('[data-emdr]') || e.target.closest('[data-emdr]')) {
                const emdrType = e.target.dataset.emdr || e.target.closest('[data-emdr]').dataset.emdr;
                console.log('🎯 EMDR type selected:', emdrType);
                EMDRHelper.startEMDRTechnique(emdrType);
            }
        });

        console.log('✅ EMDR Emergency Functions Loaded!');
    </script>
    
    <!-- Accessibility Script -->
    <script>
        // Initialize accessibility features
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved accessibility preferences
            const savedPrefs = localStorage.getItem('accessibilityPrefs');
            if (savedPrefs) {
                const prefs = JSON.parse(savedPrefs);
                if (prefs.fontSize && window.app) app.setFontSize(prefs.fontSize);
                if (prefs.highContrast) document.body.classList.add('high-contrast');
                if (prefs.reducedMotion) document.body.classList.add('reduced-motion');
                if (prefs.voiceSpeed && window.app) app.setVoiceSpeed(prefs.voiceSpeed);
            }
            
            // Accessibility toolbar toggle
            const accessibilityToggle = document.getElementById('accessibility-toggle');
            if (accessibilityToggle) {
                accessibilityToggle.addEventListener('click', function() {
                    const panel = document.getElementById('accessibility-panel');
                    panel.classList.toggle('hidden');
                    
                    // Announce to screen readers
                    if (window.app && app.announceToScreenReader) {
                        app.announceToScreenReader(
                            panel.classList.contains('hidden') 
                            ? 'Accessibility panel closed' 
                            : 'Accessibility panel opened'
                        );
                    }
                });
            }

            // Keyboard navigation enhancements
            document.addEventListener('keydown', function(e) {
                // Quick accessibility panel toggle with Alt+A
                if (e.altKey && e.key === 'a') {
                    e.preventDefault();
                    document.getElementById('accessibility-toggle')?.click();
                }
                
                // Quick high contrast toggle with Alt+C
                if (e.altKey && e.key === 'c') {
                    e.preventDefault();
                    if (window.app && app.toggleHighContrast) app.toggleHighContrast();
                }
                
                // Emergency crisis help with Alt+H
                if (e.altKey && e.key === 'h') {
                    e.preventDefault();
                    if (window.app && app.triggerCrisisSupport) app.triggerCrisisSupport();
                }
            });
        });
    </script>
</body>
</html>